<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>COMM 550-Lab 10- Factor Analysis</title>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}

pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>COMM 550-Lab 10- Factor Analysis</h1>

<pre><code class="r">#install.packages(&#39;GPArotation&#39;)
library(GPArotation)
library(psych)
library(ggplot2)
</code></pre>

<p>Let&#39;s look a a dataset which is built into R, the Motortrend Car Guide. This features
a number of variables about different cars including their miles per gallon (mpg), number of
cylinders (cyl), engine displacement (disp), horsepower (hp), rear axle ratio (drat), weight
(wt) and quarter mile time (qsec) as well as some other variables that we aren&#39;t interested in 
such as transmission type. Let&#39;s load the data, pull out the variables we need and examine it.</p>

<pre><code class="r">data(mtcars)
mtcars&lt;-mtcars[,-8:-10]
mtcars&lt;-mtcars[,-6]
head(mtcars)
</code></pre>

<pre><code>##                    mpg cyl disp  hp drat  qsec carb
## Mazda RX4         21.0   6  160 110 3.90 16.46    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 17.02    4
## Datsun 710        22.8   4  108  93 3.85 18.61    1
## Hornet 4 Drive    21.4   6  258 110 3.08 19.44    1
## Hornet Sportabout 18.7   8  360 175 3.15 17.02    2
## Valiant           18.1   6  225 105 2.76 20.22    1
</code></pre>

<p>The goal of factor analysis is to reduce the number of dimensions (variables) which are expressed
within our dataset. In this cars example we are dealing with a number of variables which may all 
reflect a smaller number of internal factors. As an example the preference for gas guzzlers may 
be reflected in high horsepower, high cylinder low MPG cars which go fast. Factor analysis looks
at the relationships between our variables and tries to find these common trends.
Factor analysis works off of a correlation matrix, let&#39;s take a look at ours</p>

<pre><code class="r">mtcor&lt;-cor(mtcars)
mtcor
</code></pre>

<pre><code>##          mpg     cyl    disp      hp     drat    qsec     carb
## mpg   1.0000 -0.8522 -0.8476 -0.7762  0.68117  0.4187 -0.55093
## cyl  -0.8522  1.0000  0.9020  0.8324 -0.69994 -0.5912  0.52699
## disp -0.8476  0.9020  1.0000  0.7909 -0.71021 -0.4337  0.39498
## hp   -0.7762  0.8324  0.7909  1.0000 -0.44876 -0.7082  0.74981
## drat  0.6812 -0.6999 -0.7102 -0.4488  1.00000  0.0912 -0.09079
## qsec  0.4187 -0.5912 -0.4337 -0.7082  0.09120  1.0000 -0.65625
## carb -0.5509  0.5270  0.3950  0.7498 -0.09079 -0.6562  1.00000
</code></pre>

<p>Not the diagonal of 1&#39;s running down the side. From this matrix we can extract the eigenvalues.
I am not going to get too deep into eigenvalues or vectors here because that leads down a linear
algebra rabbit hole that is well beyond this class. Suffice to say that eigenvectors are specific
combinations of numbers that when multiplied by a matrix lead to the same values as if they were multiplied
by a specific value, the eigenvalue. If you have more questions about how this ties into factor analysis
feel free to ask Professor Monge ;)</p>

<pre><code class="r">ev&lt;-eigen(mtcor)
ev&lt;-data.frame(ev)
</code></pre>

<p>Eigenvalues are useful for factor analysis because they provide hints at how many different underlying variables
exist within our dataset, and by extension how many we should extract from that big messy correlation matrix.
There are a couple of rules we can use to determine this. One is to look at the number of factors with an eigenvalue</p>

<blockquote>
<p>1</p>
</blockquote>

<pre><code class="r">ev$values
</code></pre>

<pre><code>## [1] 4.75119 1.33689 0.39514 0.22793 0.13941 0.09010 0.05934
</code></pre>

<p>In this case that equals two. This rule is simple but can be too strict. Another approach would be to look at what&#39;s called
a scree plot (like the sound a hawk makes when it is diving towards your head, &ldquo;SCREEEEEEEEE!&rdquo;). </p>

<pre><code class="r">qplot(y=ev$values, main=&#39;SCREE Plot&#39;, xlab=&#39;Factor #&#39;, ylab=&#39;Eigenvalue&#39;)+geom_line()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/> </p>

<p>On the scree plot (SCREEEE!) we are looking for the point where the line bends and begins to flatten out, so around
value 3. This is a subjective decision, some people might say 2 and others 4. But let&#39;s move forward extracting 3 factors
from the data.
Doing a factor analysis is dead simple, simply provide a dataframe or correlation matrix of the variables you are interested
in. If your data has other variables in it you will need to make a new dataframe or specify what you want to examine beforehand.
Running the factor analysis is easy, just input the dataframe or correlation matrix and the number of factors you
want to extract.</p>

<pre><code class="r">factan.1&lt;-fa(mtcars, nfactors= 3)
</code></pre>

<pre><code>## Loading required package: parallel
</code></pre>

<p>The summary gives us some goodness of fit tests. You generally want the Tucker Lewis Index above 0.9 and the Chi Square
test of the hypothesis that &#39;n&#39; factors and sufficient to be NOT significant. Like the Levene&#39;s test non significance 
IS GOOD in this case.</p>

<pre><code class="r">summary(factan.1)
</code></pre>

<pre><code>## 
## Factor analysis with Call: fa(r = mtcars, nfactors = 3)
## 
## Test of the hypothesis that 3 factors are sufficient.
## The degrees of freedom for the model is 3  and the objective function was  0.18 
## The number of observations was  32  with Chi Square =  4.6  with prob &lt;  0.2 
## 
## The root mean square of the residuals (RMSA) is  0.01 
## The df corrected root mean square of the residuals is  0.03 
## 
## Tucker Lewis Index of factoring reliability =  0.937
## RMSEA index =  0.165  and the 90 % confidence intervals are  NA 0.348
## BIC =  -5.79
##  With factor correlations of 
##      MR2  MR1  MR3
## MR2 1.00 0.39 0.38
## MR1 0.39 1.00 0.64
## MR3 0.38 0.64 1.00
</code></pre>

<p>We can then see how the various variables load onto the three factors. We are looking for high absolute values which 
can be used to craft a narrative about our data.</p>

<pre><code class="r">factan.1$loadings
</code></pre>

<pre><code>## 
## Loadings:
##      MR2    MR1    MR3   
## mpg  -0.815 -0.299       
## cyl   0.815         0.264
## disp  0.917         0.128
## hp    0.519  0.345  0.308
## drat -0.929  0.147  0.188
## qsec               -0.878
## carb         0.973       
## 
##                  MR2   MR1   MR3
## SS loadings    3.303 1.185 0.998
## Proportion Var 0.472 0.169 0.143
## Cumulative Var 0.472 0.641 0.784
</code></pre>

<p>These factors can be translated into scores for each row that can then be used as predictor variables in further analysis</p>

<pre><code class="r">factan.1$scores
</code></pre>

<pre><code>##                         MR2     MR1       MR3
## Mazda RX4           -0.5310  0.7158  0.552955
## Mazda RX4 Wag       -0.4999  0.7246  0.325919
## Datsun 710          -0.8866 -1.1168 -0.632133
## Hornet 4 Drive       0.2347 -1.1109 -0.888113
## Hornet Sportabout    0.9170 -0.5260  0.489787
## Valiant              0.3770 -1.0873 -1.389280
## Duster 360           1.0043  0.7218  1.085620
## Merc 240D           -0.8269 -0.4786 -1.262392
## Merc 230            -0.6264 -0.4261 -2.335353
## Merc 280            -0.3283  0.7508 -0.203916
## Merc 280C           -0.2453  0.7643 -0.488106
## Merc 450SE           0.7721  0.1142  0.283330
## Merc 450SL           0.7513  0.1148  0.228562
## Merc 450SLC          0.8480  0.1272  0.004989
## Cadillac Fleetwood   1.5613  0.7609 -0.082647
## Lincoln Continental  1.5199  0.7593  0.028104
## Chrysler Imperial    1.2609  0.7417  0.414484
## Fiat 128            -1.3570 -1.1329 -0.721915
## Honda Civic         -1.6280 -0.5223 -0.219039
## Toyota Corolla      -1.4421 -1.1308 -0.821790
## Toyota Corona       -0.6876 -1.0905 -1.262289
## Dodge Challenger     0.9643 -0.5184  0.294969
## AMC Javelin          0.8669 -0.5118  0.204759
## Camaro Z28           0.8630  0.7163  1.354152
## Pontiac Firebird     1.0241 -0.5280  0.473758
## Fiat X1-9           -1.2071 -1.1273 -0.639964
## Porsche 914-2       -1.2694 -0.5348  0.381915
## Lotus Europa        -1.2846 -0.5391  0.337899
## Ford Pantera L       0.6385  0.6945  1.966627
## Ferrari Dino        -0.5067  1.9596  1.056196
## Maserati Bora        0.6149  3.2050  2.009752
## Volvo 142E          -0.8916 -0.4889 -0.546839
</code></pre>

<p>The issue with factor analysis is that it tends to overload the first factors in the model, by rotating the model
we can have a more even distribution. Rotations can be orthogonal (all factors are independent) or oblique (factors
can correlate). Let&#39;s look at varimax a popular orthogonal rotation</p>

<pre><code class="r">r.factan.3&lt;-fa(mtcars, nfactors = 3, rotate=&#39;varimax&#39;)
summary(r.factan.3)
</code></pre>

<pre><code>## 
## Factor analysis with Call: fa(r = mtcars, nfactors = 3, rotate = &quot;varimax&quot;)
## 
## Test of the hypothesis that 3 factors are sufficient.
## The degrees of freedom for the model is 3  and the objective function was  0.18 
## The number of observations was  32  with Chi Square =  4.6  with prob &lt;  0.2 
## 
## The root mean square of the residuals (RMSA) is  0.01 
## The df corrected root mean square of the residuals is  0.03 
## 
## Tucker Lewis Index of factoring reliability =  0.937
## RMSEA index =  0.165  and the 90 % confidence intervals are  NA 0.348
## BIC =  -5.79
</code></pre>

<pre><code class="r">r.factan.3$loadings
</code></pre>

<pre><code>## 
## Loadings:
##      MR2    MR1    MR3   
## mpg  -0.813 -0.402 -0.181
## cyl   0.819  0.275  0.431
## disp  0.888  0.175  0.297
## hp    0.586  0.520  0.515
## drat -0.846              
## qsec -0.147 -0.352 -0.851
## carb  0.142  0.916  0.368
## 
##                  MR2   MR1   MR3
## SS loadings    3.222 1.503 1.433
## Proportion Var 0.460 0.215 0.205
## Cumulative Var 0.460 0.675 0.880
</code></pre>

<p>From this we can see that MR2 has a strong positive loading for Cylinders and Engine Displacement
as well as a negative loading for miles per gallon and rear axle ration. MR1 seems to be primarily
the amount of carburetors the car has while MR3 has a strong negative relationship with quarter mile time (ie
really fast cars). We can extract these scores into our original dataframe for use in further analysis</p>

<pre><code class="r">mtscores&lt;-data.frame(r.factan.3$scores)
mtscores
</code></pre>

<pre><code>##                         MR2      MR1      MR3
## Mazda RX4           -0.7978  0.73633  0.44004
## Mazda RX4 Wag       -0.7227  0.83902  0.15228
## Datsun 710          -0.6714 -1.00974 -0.23510
## Hornet 4 Drive       0.6001 -1.04886 -0.66297
## Hornet Sportabout    0.9936 -0.99234  0.73516
## Valiant              0.8456 -0.82712 -1.30701
## Duster 360           0.7780  0.30712  0.94848
## Merc 240D           -0.5900  0.04781 -1.28508
## Merc 230            -0.1784  0.53914 -2.65459
## Merc 280            -0.4402  1.07192 -0.53111
## Merc 280C           -0.2985  1.19743 -0.89657
## Merc 450SE           0.7718 -0.08309  0.22885
## Merc 450SL           0.7593 -0.05637  0.16282
## Merc 450SLC          0.9048  0.04021 -0.12845
## Cadillac Fleetwood   1.5989  0.77268 -0.56796
## Lincoln Continental  1.5332  0.72965 -0.42620
## Chrysler Imperial    1.1808  0.58009  0.08452
## Fiat 128            -1.1656 -0.92710 -0.29409
## Honda Civic         -1.6533 -0.33720  0.10227
## Toyota Corolla      -1.2402 -0.87051 -0.41039
## Toyota Corona       -0.3402 -0.73801 -1.04543
## Dodge Challenger     1.0806 -0.90706  0.48623
## AMC Javelin          0.9901 -0.84717  0.38122
## Camaro Z28           0.5742  0.20625  1.29691
## Pontiac Firebird     1.1139 -1.00289  0.70579
## Fiat X1-9           -1.0182 -0.97535 -0.20945
## Porsche 914-2       -1.3723 -0.65618  0.81677
## Lotus Europa        -1.3800 -0.64092  0.76555
## Ford Pantera L       0.2178 -0.04889  2.08596
## Ferrari Dino        -1.0642  2.07850  0.54651
## Maserati Bora       -0.2170  3.08114  1.10365
## Volvo 142E          -0.7931 -0.25848 -0.38863
</code></pre>

<pre><code class="r">mtcars$GasGuz&lt;-mtscores$MR2
mtcars$Carb&lt;-mtscores$MR1
mtcars$Speedy&lt;-mtscores$MR3
</code></pre>

<p>By examining the various scores in descending order we can see the various narratives played out!</p>

<pre><code class="r">mtcars[order(-mtcars$GasGuz),] 
</code></pre>

<pre><code>##                      mpg cyl  disp  hp drat  qsec carb  GasGuz     Carb
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 17.98    4  1.5989  0.77268
## Lincoln Continental 10.4   8 460.0 215 3.00 17.82    4  1.5332  0.72965
## Chrysler Imperial   14.7   8 440.0 230 3.23 17.42    4  1.1808  0.58009
## Pontiac Firebird    19.2   8 400.0 175 3.08 17.05    2  1.1139 -1.00289
## Dodge Challenger    15.5   8 318.0 150 2.76 16.87    2  1.0806 -0.90706
## Hornet Sportabout   18.7   8 360.0 175 3.15 17.02    2  0.9936 -0.99234
## AMC Javelin         15.2   8 304.0 150 3.15 17.30    2  0.9901 -0.84717
## Merc 450SLC         15.2   8 275.8 180 3.07 18.00    3  0.9048  0.04021
## Valiant             18.1   6 225.0 105 2.76 20.22    1  0.8456 -0.82712
## Duster 360          14.3   8 360.0 245 3.21 15.84    4  0.7780  0.30712
## Merc 450SE          16.4   8 275.8 180 3.07 17.40    3  0.7718 -0.08309
## Merc 450SL          17.3   8 275.8 180 3.07 17.60    3  0.7593 -0.05637
## Hornet 4 Drive      21.4   6 258.0 110 3.08 19.44    1  0.6001 -1.04886
## Camaro Z28          13.3   8 350.0 245 3.73 15.41    4  0.5742  0.20625
## Ford Pantera L      15.8   8 351.0 264 4.22 14.50    4  0.2178 -0.04889
## Merc 230            22.8   4 140.8  95 3.92 22.90    2 -0.1784  0.53914
## Maserati Bora       15.0   8 301.0 335 3.54 14.60    8 -0.2170  3.08114
## Merc 280C           17.8   6 167.6 123 3.92 18.90    4 -0.2985  1.19743
## Toyota Corona       21.5   4 120.1  97 3.70 20.01    1 -0.3402 -0.73801
## Merc 280            19.2   6 167.6 123 3.92 18.30    4 -0.4402  1.07192
## Merc 240D           24.4   4 146.7  62 3.69 20.00    2 -0.5900  0.04781
## Datsun 710          22.8   4 108.0  93 3.85 18.61    1 -0.6714 -1.00974
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 17.02    4 -0.7227  0.83902
## Volvo 142E          21.4   4 121.0 109 4.11 18.60    2 -0.7931 -0.25848
## Mazda RX4           21.0   6 160.0 110 3.90 16.46    4 -0.7978  0.73633
## Fiat X1-9           27.3   4  79.0  66 4.08 18.90    1 -1.0182 -0.97535
## Ferrari Dino        19.7   6 145.0 175 3.62 15.50    6 -1.0642  2.07850
## Fiat 128            32.4   4  78.7  66 4.08 19.47    1 -1.1656 -0.92710
## Toyota Corolla      33.9   4  71.1  65 4.22 19.90    1 -1.2402 -0.87051
## Porsche 914-2       26.0   4 120.3  91 4.43 16.70    2 -1.3723 -0.65618
## Lotus Europa        30.4   4  95.1 113 3.77 16.90    2 -1.3800 -0.64092
## Honda Civic         30.4   4  75.7  52 4.93 18.52    2 -1.6533 -0.33720
##                       Speedy
## Cadillac Fleetwood  -0.56796
## Lincoln Continental -0.42620
## Chrysler Imperial    0.08452
## Pontiac Firebird     0.70579
## Dodge Challenger     0.48623
## Hornet Sportabout    0.73516
## AMC Javelin          0.38122
## Merc 450SLC         -0.12845
## Valiant             -1.30701
## Duster 360           0.94848
## Merc 450SE           0.22885
## Merc 450SL           0.16282
## Hornet 4 Drive      -0.66297
## Camaro Z28           1.29691
## Ford Pantera L       2.08596
## Merc 230            -2.65459
## Maserati Bora        1.10365
## Merc 280C           -0.89657
## Toyota Corona       -1.04543
## Merc 280            -0.53111
## Merc 240D           -1.28508
## Datsun 710          -0.23510
## Mazda RX4 Wag        0.15228
## Volvo 142E          -0.38863
## Mazda RX4            0.44004
## Fiat X1-9           -0.20945
## Ferrari Dino         0.54651
## Fiat 128            -0.29409
## Toyota Corolla      -0.41039
## Porsche 914-2        0.81677
## Lotus Europa         0.76555
## Honda Civic          0.10227
</code></pre>

<pre><code class="r">mtcars[order(-mtcars$Carb),]
</code></pre>

<pre><code>##                      mpg cyl  disp  hp drat  qsec carb  GasGuz     Carb
## Maserati Bora       15.0   8 301.0 335 3.54 14.60    8 -0.2170  3.08114
## Ferrari Dino        19.7   6 145.0 175 3.62 15.50    6 -1.0642  2.07850
## Merc 280C           17.8   6 167.6 123 3.92 18.90    4 -0.2985  1.19743
## Merc 280            19.2   6 167.6 123 3.92 18.30    4 -0.4402  1.07192
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 17.02    4 -0.7227  0.83902
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 17.98    4  1.5989  0.77268
## Mazda RX4           21.0   6 160.0 110 3.90 16.46    4 -0.7978  0.73633
## Lincoln Continental 10.4   8 460.0 215 3.00 17.82    4  1.5332  0.72965
## Chrysler Imperial   14.7   8 440.0 230 3.23 17.42    4  1.1808  0.58009
## Merc 230            22.8   4 140.8  95 3.92 22.90    2 -0.1784  0.53914
## Duster 360          14.3   8 360.0 245 3.21 15.84    4  0.7780  0.30712
## Camaro Z28          13.3   8 350.0 245 3.73 15.41    4  0.5742  0.20625
## Merc 240D           24.4   4 146.7  62 3.69 20.00    2 -0.5900  0.04781
## Merc 450SLC         15.2   8 275.8 180 3.07 18.00    3  0.9048  0.04021
## Ford Pantera L      15.8   8 351.0 264 4.22 14.50    4  0.2178 -0.04889
## Merc 450SL          17.3   8 275.8 180 3.07 17.60    3  0.7593 -0.05637
## Merc 450SE          16.4   8 275.8 180 3.07 17.40    3  0.7718 -0.08309
## Volvo 142E          21.4   4 121.0 109 4.11 18.60    2 -0.7931 -0.25848
## Honda Civic         30.4   4  75.7  52 4.93 18.52    2 -1.6533 -0.33720
## Lotus Europa        30.4   4  95.1 113 3.77 16.90    2 -1.3800 -0.64092
## Porsche 914-2       26.0   4 120.3  91 4.43 16.70    2 -1.3723 -0.65618
## Toyota Corona       21.5   4 120.1  97 3.70 20.01    1 -0.3402 -0.73801
## Valiant             18.1   6 225.0 105 2.76 20.22    1  0.8456 -0.82712
## AMC Javelin         15.2   8 304.0 150 3.15 17.30    2  0.9901 -0.84717
## Toyota Corolla      33.9   4  71.1  65 4.22 19.90    1 -1.2402 -0.87051
## Dodge Challenger    15.5   8 318.0 150 2.76 16.87    2  1.0806 -0.90706
## Fiat 128            32.4   4  78.7  66 4.08 19.47    1 -1.1656 -0.92710
## Fiat X1-9           27.3   4  79.0  66 4.08 18.90    1 -1.0182 -0.97535
## Hornet Sportabout   18.7   8 360.0 175 3.15 17.02    2  0.9936 -0.99234
## Pontiac Firebird    19.2   8 400.0 175 3.08 17.05    2  1.1139 -1.00289
## Datsun 710          22.8   4 108.0  93 3.85 18.61    1 -0.6714 -1.00974
## Hornet 4 Drive      21.4   6 258.0 110 3.08 19.44    1  0.6001 -1.04886
##                       Speedy
## Maserati Bora        1.10365
## Ferrari Dino         0.54651
## Merc 280C           -0.89657
## Merc 280            -0.53111
## Mazda RX4 Wag        0.15228
## Cadillac Fleetwood  -0.56796
## Mazda RX4            0.44004
## Lincoln Continental -0.42620
## Chrysler Imperial    0.08452
## Merc 230            -2.65459
## Duster 360           0.94848
## Camaro Z28           1.29691
## Merc 240D           -1.28508
## Merc 450SLC         -0.12845
## Ford Pantera L       2.08596
## Merc 450SL           0.16282
## Merc 450SE           0.22885
## Volvo 142E          -0.38863
## Honda Civic          0.10227
## Lotus Europa         0.76555
## Porsche 914-2        0.81677
## Toyota Corona       -1.04543
## Valiant             -1.30701
## AMC Javelin          0.38122
## Toyota Corolla      -0.41039
## Dodge Challenger     0.48623
## Fiat 128            -0.29409
## Fiat X1-9           -0.20945
## Hornet Sportabout    0.73516
## Pontiac Firebird     0.70579
## Datsun 710          -0.23510
## Hornet 4 Drive      -0.66297
</code></pre>

<pre><code class="r">mtcars[order(-mtcars$Speedy),]
</code></pre>

<pre><code>##                      mpg cyl  disp  hp drat  qsec carb  GasGuz     Carb
## Ford Pantera L      15.8   8 351.0 264 4.22 14.50    4  0.2178 -0.04889
## Camaro Z28          13.3   8 350.0 245 3.73 15.41    4  0.5742  0.20625
## Maserati Bora       15.0   8 301.0 335 3.54 14.60    8 -0.2170  3.08114
## Duster 360          14.3   8 360.0 245 3.21 15.84    4  0.7780  0.30712
## Porsche 914-2       26.0   4 120.3  91 4.43 16.70    2 -1.3723 -0.65618
## Lotus Europa        30.4   4  95.1 113 3.77 16.90    2 -1.3800 -0.64092
## Hornet Sportabout   18.7   8 360.0 175 3.15 17.02    2  0.9936 -0.99234
## Pontiac Firebird    19.2   8 400.0 175 3.08 17.05    2  1.1139 -1.00289
## Ferrari Dino        19.7   6 145.0 175 3.62 15.50    6 -1.0642  2.07850
## Dodge Challenger    15.5   8 318.0 150 2.76 16.87    2  1.0806 -0.90706
## Mazda RX4           21.0   6 160.0 110 3.90 16.46    4 -0.7978  0.73633
## AMC Javelin         15.2   8 304.0 150 3.15 17.30    2  0.9901 -0.84717
## Merc 450SE          16.4   8 275.8 180 3.07 17.40    3  0.7718 -0.08309
## Merc 450SL          17.3   8 275.8 180 3.07 17.60    3  0.7593 -0.05637
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 17.02    4 -0.7227  0.83902
## Honda Civic         30.4   4  75.7  52 4.93 18.52    2 -1.6533 -0.33720
## Chrysler Imperial   14.7   8 440.0 230 3.23 17.42    4  1.1808  0.58009
## Merc 450SLC         15.2   8 275.8 180 3.07 18.00    3  0.9048  0.04021
## Fiat X1-9           27.3   4  79.0  66 4.08 18.90    1 -1.0182 -0.97535
## Datsun 710          22.8   4 108.0  93 3.85 18.61    1 -0.6714 -1.00974
## Fiat 128            32.4   4  78.7  66 4.08 19.47    1 -1.1656 -0.92710
## Volvo 142E          21.4   4 121.0 109 4.11 18.60    2 -0.7931 -0.25848
## Toyota Corolla      33.9   4  71.1  65 4.22 19.90    1 -1.2402 -0.87051
## Lincoln Continental 10.4   8 460.0 215 3.00 17.82    4  1.5332  0.72965
## Merc 280            19.2   6 167.6 123 3.92 18.30    4 -0.4402  1.07192
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 17.98    4  1.5989  0.77268
## Hornet 4 Drive      21.4   6 258.0 110 3.08 19.44    1  0.6001 -1.04886
## Merc 280C           17.8   6 167.6 123 3.92 18.90    4 -0.2985  1.19743
## Toyota Corona       21.5   4 120.1  97 3.70 20.01    1 -0.3402 -0.73801
## Merc 240D           24.4   4 146.7  62 3.69 20.00    2 -0.5900  0.04781
## Valiant             18.1   6 225.0 105 2.76 20.22    1  0.8456 -0.82712
## Merc 230            22.8   4 140.8  95 3.92 22.90    2 -0.1784  0.53914
##                       Speedy
## Ford Pantera L       2.08596
## Camaro Z28           1.29691
## Maserati Bora        1.10365
## Duster 360           0.94848
## Porsche 914-2        0.81677
## Lotus Europa         0.76555
## Hornet Sportabout    0.73516
## Pontiac Firebird     0.70579
## Ferrari Dino         0.54651
## Dodge Challenger     0.48623
## Mazda RX4            0.44004
## AMC Javelin          0.38122
## Merc 450SE           0.22885
## Merc 450SL           0.16282
## Mazda RX4 Wag        0.15228
## Honda Civic          0.10227
## Chrysler Imperial    0.08452
## Merc 450SLC         -0.12845
## Fiat X1-9           -0.20945
## Datsun 710          -0.23510
## Fiat 128            -0.29409
## Volvo 142E          -0.38863
## Toyota Corolla      -0.41039
## Lincoln Continental -0.42620
## Merc 280            -0.53111
## Cadillac Fleetwood  -0.56796
## Hornet 4 Drive      -0.66297
## Merc 280C           -0.89657
## Toyota Corona       -1.04543
## Merc 240D           -1.28508
## Valiant             -1.30701
## Merc 230            -2.65459
</code></pre>

</body>

</html>
